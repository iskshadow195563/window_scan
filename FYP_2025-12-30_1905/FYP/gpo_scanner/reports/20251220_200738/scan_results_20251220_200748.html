<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GPO 掃描報告</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  body{font-family:Inter,Arial,Helvetica,sans-serif;margin:0;background:#f7f9fb;color:#222}
  .container{max-width:1100px;margin:24px auto;padding:20px;background:#fff;border-radius:8px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
  h1{margin:0 0 8px;font-size:22px}
  .meta{color:#666;margin-bottom:16px}
  .score-box{display:flex;align-items:center;gap:16px;margin-bottom:18px}
  .score-value{font-size:28px;font-weight:700;color:#1565c0}
  .chart-wrap{width:100%;max-width:900px;margin-bottom:20px}
  table{width:100%;border-collapse:collapse;margin-top:12px}
  th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
  th{background:#fafafa;color:#333}
  tr.category-row td{background:#f1f5f9;font-weight:700}
  .legend{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  .note{margin-top:12px;color:#555;font-size:13px}
</style>
</head>
<body>
<div class="container">
  <h1>GPO 掃描報告</h1>
  <div class="meta">產生時間: 2025-12-20 20:08:34.313927 &nbsp;|&nbsp; 整體加權安全評分: <strong>37.97%</strong></div>
  <div class="score-box">
    <div>
      <div class="score-value">37.97%</div>
      <div class="note">分數越高代表符合越多高權重檢查</div>
    </div>
    <div style="flex:1">
      <div class="chart-wrap">
        <canvas id="vulnChart" width="900" height="300"></canvas>
      </div>
    </div>
  </div>
  <h2>檢查明細</h2>
  <table>
    <thead><tr><th>檢查項目</th><th>結果</th><th>權重</th><th>威脅等級</th></tr></thead>
    <tbody>
      <tr class='category-row'><td colspan='4'><strong>帳號與身份驗證</strong></td></tr><tr><td>1. 禁用 Guest 帳號</td><td>PASS</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>2. Administrator 帳號應禁用或重新命名</td><td>FAIL</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>3. 密碼最小長度 ≥ 12</td><td>ERROR: not found</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>4. 密碼複雜度啟用</td><td>ERROR: not found</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>5. 密碼重複使用限制 ≥ 24</td><td>ERROR: not found</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>6. 密碼最長使用期限 ≤ 90 天</td><td>ERROR: not found</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>7. 密碼最短使用期限 ≥ 1 天</td><td>ERROR: not found</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>8. 帳號鎖定閾值 ≤ 5 次失敗</td><td>ERROR: not found</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>9. 帳號鎖定持續時間 ≥ 15 分鐘</td><td>ERROR: not found</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>10. Kerberos 強加密啟用</td><td>FAIL</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr class='category-row'><td colspan='4'><strong>登入與存取控制</strong></td></tr><tr><td>11. 禁止匿名 SID/名稱轉換</td><td>ERROR: ERROR: Get-ItemProperty : Property TurnOffAnonymousBlock does not exist at path 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa.
At line:1 char:1
+ Get-ItemProperty -Path &#39;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa&#39; - ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (TurnOffAnonymousBlock:String) [Get-ItemProperty], PSArgumentException
    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemPr 
   opertyCommand</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>12. 禁止匿名列舉 SAM 帳號</td><td>FAIL</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>13. 顯示登入法律聲明</td><td>FAIL</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr><td>14. 禁止快取上次登入使用者名稱</td><td>FAIL</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>15. 禁止遠端桌面 (若不需要)</td><td>PASS</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>16. 啟用智慧卡或 MFA</td><td>FAIL</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>17. 限制本地管理員群組成員數量</td><td>ERROR: ERROR: Get-LocalGroupMember : Group Administrators was not found.
At line:1 char:1
+ Get-LocalGroupMember -Group &#39;Administrators&#39; | Select-Object -Propert ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Administrators:String) [Get-LocalGroupMember], GroupNotFoundException
    + FullyQualifiedErrorId : GroupNotFound,Microsoft.PowerShell.Commands.GetLocalGroupMemberCommand</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>18. 禁止空白密碼登入</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>19. 保留項目 A</td><td>ERROR: ERROR: Get-LocalGroupMember : Group Administrators was not found.
At line:1 char:1
+ Get-LocalGroupMember -Group &#39;Administrators&#39; | Select-Object -Propert ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Administrators:String) [Get-LocalGroupMember], GroupNotFoundException
    + FullyQualifiedErrorId : GroupNotFound,Microsoft.PowerShell.Commands.GetLocalGroupMemberCommand</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr><td>20. 保留項目 B</td><td>ERROR: ERROR: Get-LocalGroupMember : Group Administrators was not found.
At line:1 char:1
+ Get-LocalGroupMember -Group &#39;Administrators&#39; | Select-Object -Propert ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Administrators:String) [Get-LocalGroupMember], GroupNotFoundException
    + FullyQualifiedErrorId : GroupNotFound,Microsoft.PowerShell.Commands.GetLocalGroupMemberCommand</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr class='category-row'><td colspan='4'><strong>系統服務與設定</strong></td></tr><tr><td>21. 停用 Telnet 服務</td><td>ERROR: ERROR: Return code 1</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>22. 停用 FTP 服務</td><td>ERROR: ERROR: Return code 1</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>23. 停用 SMBv1 協定</td><td>PASS</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>24. 啟用 Windows Defender</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>25. 啟用 Windows 防火牆</td><td>PASS</td><td>5</td><td style='color:#c62828;font-weight:600'>Critical</td></tr><tr><td>26. 停用 Remote Registry 服務</td><td>ERROR: &#39;int&#39; object has no attribute &#39;lower&#39;</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>27. 停用未使用的網路介面</td><td>PASS</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr><td>28. 啟用 BitLocker 磁碟加密</td><td>ERROR: ERROR: Get-BitLockerVolume : The term &#39;Get-BitLockerVolume&#39; is not recognized as the name of a cmdlet, function, script file, 
or operable program. Check the spelling of the name, or if a path was included, verify that the path is correct and 
try again.
At line:1 char:1
+ Get-BitLockerVolume | Select-Object -Property MountPoint,ProtectionSt ...
+ ~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (Get-BitLockerVolume:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>29. 啟用 Secure Boot</td><td>PASS</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>30. 啟用 Credential Guard</td><td>PASS</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr class='category-row'><td colspan='4'><strong>事件日誌與稽核</strong></td></tr><tr><td>31. 啟用登入稽核</td><td>ERROR: name &#39;json&#39; is not defined</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>32. 啟用物件存取稽核</td><td>ERROR: name &#39;json&#39; is not defined</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>33. 啟用稽核策略變更</td><td>ERROR: name &#39;json&#39; is not defined</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>34. 啟用系統事件稽核</td><td>ERROR: name &#39;json&#39; is not defined</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>35. 啟用權限使用稽核</td><td>ERROR: name &#39;json&#39; is not defined</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>36. 啟用進程追蹤稽核</td><td>ERROR: name &#39;json&#39; is not defined</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr><td>37. 安全日誌大小 ≥ 512MB</td><td>PASS</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>38. 系統日誌大小 ≥ 512MB</td><td>PASS</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>39. 應用程式日誌大小 ≥ 256MB</td><td>PASS</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr><tr><td>40. 日誌覆寫/保留策略設定</td><td>PASS</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr class='category-row'><td colspan='4'><strong>網路安全</strong></td></tr><tr><td>41. 禁止弱加密檢查</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>42. 啟用 TLS 1.2/1.3 支援</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>43. 禁用 SSL 2.0/3.0</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>44. 啟用 IPsec 規則</td><td>FAIL</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>45. LM Hash 儲存限制 (LmCompatibilityLevel)</td><td>ERROR: ERROR: Get-ItemProperty : Property LmCompatibilityLevel does not exist at path 
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa.
At line:1 char:1
+ Get-ItemProperty -Path &#39;HKLM:\SYSTEM\CurrentControlSet\Control\Lsa&#39; - ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidArgument: (LmCompatibilityLevel:String) [Get-ItemProperty], PSArgumentException
    + FullyQualifiedErrorId : System.Management.Automation.PSArgumentException,Microsoft.PowerShell.Commands.GetItemPr 
   opertyCommand</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>46. 禁用 NTLMv1</td><td>PASS</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>47. 防火牆阻擋未授權入站流量</td><td>FAIL</td><td>4</td><td style='color:#ef6c00;font-weight:600'>High</td></tr><tr><td>48. 防火牆阻擋未授權出站流量</td><td>FAIL</td><td>3</td><td style='color:#f9a825;font-weight:600'>Medium</td></tr><tr><td>49. DNSSEC 或 DNS 伺服器角色檢查</td><td>PASS</td><td>2</td><td style='color:#2e7d32;font-weight:600'>Low</td></tr><tr><td>50. 其他網路檢查</td><td>PASS</td><td>1</td><td style='color:#1565c0;font-weight:600'>Info</td></tr>
    </tbody>
  </table>
  <div class="note">
    <strong>說明：</strong>圖表列出掃描中所有 FAIL/ERROR 的檢查項目，並以權重顯示其相對重要性。
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const labels = ["2. Administrator 帳號應禁用或重新命名", "3. 密碼最小長度 ≥ 12", "4. 密碼複雜度啟用", "5. 密碼重複使用限制 ≥ 24", "6. 密碼最長使用期限 ≤ 90 天", "7. 密碼最短使用期限 ≥ 1 天", "8. 帳號鎖定閾值 ≤ 5 次失敗", "9. 帳號鎖定持續時間 ≥ 15 分鐘", "10. Kerberos 強加密啟用", "11. 禁止匿名 SID/名稱轉換", "12. 禁止匿名列舉 SAM 帳號", "13. 顯示登入法律聲明", "14. 禁止快取上次登入使用者名稱", "16. 啟用智慧卡或 MFA", "17. 限制本地管理員群組成員數量", "19. 保留項目 A", "20. 保留項目 B", "21. 停用 Telnet 服務", "22. 停用 FTP 服務", "26. 停用 Remote Registry 服務", "28. 啟用 BitLocker 磁碟加密", "31. 啟用登入稽核", "32. 啟用物件存取稽核", "33. 啟用稽核策略變更", "34. 啟用系統事件稽核", "35. 啟用權限使用稽核", "36. 啟用進程追蹤稽核", "44. 啟用 IPsec 規則", "45. LM Hash 儲存限制 (LmCompatibilityLevel)", "47. 防火牆阻擋未授權入站流量", "48. 防火牆阻擋未授權出站流量"];
  const data = {
    labels: labels,
    datasets: [{
      label: '權重 (重要性)',
      data: [5, 5, 4, 3, 3, 2, 4, 3, 3, 5, 5, 1, 2, 4, 3, 1, 1, 4, 3, 4, 4, 4, 3, 3, 2, 2, 1, 3, 4, 4, 3],
      backgroundColor: ["#c62828", "#c62828", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#ef6c00", "#f9a825", "#f9a825", "#c62828", "#c62828", "#1565c0", "#2e7d32", "#ef6c00", "#f9a825", "#1565c0", "#1565c0", "#ef6c00", "#f9a825", "#ef6c00", "#ef6c00", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#2e7d32", "#1565c0", "#f9a825", "#ef6c00", "#ef6c00", "#f9a825"],
      borderColor: ["#c62828", "#c62828", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#ef6c00", "#f9a825", "#f9a825", "#c62828", "#c62828", "#1565c0", "#2e7d32", "#ef6c00", "#f9a825", "#1565c0", "#1565c0", "#ef6c00", "#f9a825", "#ef6c00", "#ef6c00", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#2e7d32", "#1565c0", "#f9a825", "#ef6c00", "#ef6c00", "#f9a825"],
      borderWidth: 1
    }]
  };
  const config = {
    type: 'bar',
    data: data,
    options: {
      indexAxis: 'y',
      scales: { x: { beginAtZero: true, ticks: { stepSize: 1 } } },
      plugins: { legend: { display: false } }
    }
  };
  new Chart(document.getElementById('vulnChart'), config);
</script>
</body>
</html>
