<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>GPO 掃描報告</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{ --bg:#f6f8fb; --card:#fff; --muted:#6b7280; --accent:#1565c0; --radius:10px;
--critical:#c62828; --high:#ef6c00; --medium:#f9a825; --low:#2e7d32; --info:#1565c0; }
html,body{height:100%;margin:0;font-family:Inter,Arial,Helvetica,sans-serif;background:var(--bg);color:#111}
.container{max-width:1200px;margin:28px auto;padding:18px}
.header{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
.title{font-size:20px;font-weight:700}
.meta{color:var(--muted);font-size:13px}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:16px}
.card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 8px 24px rgba(16,24,40,0.06)}
.card h3{margin:0 0 8px;font-size:16px}
.stat{font-size:22px;font-weight:700;color:var(--accent)}
.small{color:var(--muted);font-size:13px}
.chart{height:260px}
.table-wrap{max-height:260px;overflow:auto;margin-top:10px;border-top:1px solid #f1f5f9;padding-top:8px}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #f3f6f9;text-align:left;font-size:13px}
th{background:#fbfdff;font-weight:700}
.cat-row td{background:#f8fafc;font-weight:700}
.badge{display:inline-block;padding:4px 8px;border-radius:8px;font-weight:700;color:#fff}
.badge.pass{background:var(--info)}
.badge.fail{background:var(--critical)}
.badge.err{background:#6b7280}
@media (max-width:980px){.grid{grid-template-columns:1fr;} .chart{height:200px}}
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <div class="title">GPO 掃描報告</div>
      <div class="meta">產生時間: 2025-12-20 20:48:30  |  整體加權安全評分: <strong>51.27%</strong></div>
    </div>
    <div style="text-align:right">
      <div class="stat">51.27%</div>
      <div class="small">分數越高代表符合越多高權重檢查</div>
    </div>
  </div>

  <div class="grid">
    <!-- PASS 區 -->
    <div class="card" id="passCard">
      <h3>通過 (PASS) <span class="small">共 27 項</span></h3>
      <div class="chart"><canvas id="passChart"></canvas></div>
      <div class="table-wrap">
        <table>
          <thead><tr><th>檢查項目</th><th>結果</th><th>權重</th><th>等級</th></tr></thead>
          <tbody>
<tr><td>1. 禁用 Guest 帳號</td><td><span class='badge pass'>PASS</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>4. 密碼複雜度啟用</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>5. 密碼重複使用限制 ≥ 24</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>6. 密碼最長使用期限 ≤ 90 天</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>7. 密碼最短使用期限 ≥ 1 天</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>15. 禁止遠端桌面 (若不需要)</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>18. 禁止空白密碼登入</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>23. 停用 SMBv1 協定</td><td><span class='badge pass'>PASS</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>24. 啟用 Windows Defender</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>25. 啟用 Windows 防火牆</td><td><span class='badge pass'>PASS</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>27. 停用未使用的網路介面</td><td><span class='badge pass'>PASS</span></td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>29. 啟用 Secure Boot</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>31. 啟用登入稽核</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>32. 啟用物件存取稽核</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>33. 啟用稽核策略變更</td><td><span class='badge pass'>PASS</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>34. 啟用系統事件稽核</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>35. 啟用權限使用稽核</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>36. 啟用進程追蹤稽核</td><td><span class='badge pass'>PASS</span></td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>38. 系統日誌大小 ≥ 512MB</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>39. 應用程式日誌大小 ≥ 256MB</td><td><span class='badge pass'>PASS</span></td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>40. 日誌覆寫/保留策略設定</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>41. 禁止弱加密檢查</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>42. 啟用 TLS 1.2/1.3 支援</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>43. 禁用 SSL 2.0/3.0</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>46. 禁用 NTLMv1</td><td><span class='badge pass'>PASS</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>49. DNSSEC 或 DNS 伺服器角色檢查</td><td><span class='badge pass'>PASS</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>50. 其他網路檢查</td><td><span class='badge pass'>PASS</span></td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- FAIL 區 -->
    <div class="card" id="failCard">
      <h3>不通過 (FAIL) <span class="small">共 12 項</span></h3>
      <div class="chart"><canvas id="failChart"></canvas></div>
      <div class="table-wrap">
        <table>
          <thead><tr><th>檢查項目</th><th>結果</th><th>權重</th><th>等級</th></tr></thead>
          <tbody>
<tr><td>2. Administrator 帳號應禁用或重新命名</td><td><span class='badge fail'>FAIL</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>3. 密碼最小長度 ≥ 12</td><td><span class='badge fail'>FAIL</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>8. 帳號鎖定閾值 ≤ 5 次失敗</td><td><span class='badge fail'>FAIL</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>10. Kerberos 強加密啟用</td><td><span class='badge fail'>FAIL</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>12. 禁止匿名列舉 SAM 帳號</td><td><span class='badge fail'>FAIL</span></td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>13. 顯示登入法律聲明</td><td><span class='badge fail'>FAIL</span></td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>14. 禁止快取上次登入使用者名稱</td><td><span class='badge fail'>FAIL</span></td><td>2</td><td style='color:#2e7d32;font-weight:700'>Low</td></tr>
<tr><td>16. 啟用智慧卡或 MFA</td><td><span class='badge fail'>FAIL</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>37. 安全日誌大小 ≥ 512MB</td><td><span class='badge fail'>FAIL</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>44. 啟用 IPsec 規則</td><td><span class='badge fail'>FAIL</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>47. 防火牆阻擋未授權入站流量</td><td><span class='badge fail'>FAIL</span></td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>48. 防火牆阻擋未授權出站流量</td><td><span class='badge fail'>FAIL</span></td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ERROR 區 -->
    <div class="card" id="errCard">
      <h3>錯誤 (ERROR) <span class="small">共 11 項</span></h3>
      <div class="chart"><canvas id="errChart"></canvas></div>
      <div class="table-wrap">
        <table>
          <thead><tr><th>檢查項目</th><th>錯誤訊息</th><th>權重</th><th>等級</th></tr></thead>
          <tbody>
<tr><td>9. 帳號鎖定持續時間 ≥ 15 分鐘</td><td style='color:#6b7280;font-size:12px'>ERROR: LockoutDuration not found</td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>11. 禁止匿名 SID/名稱轉換</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>5</td><td style='color:#c62828;font-weight:700'>Critical</td></tr>
<tr><td>17. 限制本地管理員群組成員數量</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>19. 保留項目 A</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>20. 保留項目 B</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>1</td><td style='color:#1565c0;font-weight:700'>Info</td></tr>
<tr><td>21. 停用 Telnet 服務</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>22. 停用 FTP 服務</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>26. 停用 Remote Registry 服務</td><td style='color:#6b7280;font-size:12px'>ERROR: &#x27;int&#x27; object has no attribute &#x27;lower&#x27;</td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>28. 啟用 BitLocker 磁碟加密</td><td style='color:#6b7280;font-size:12px'>ERROR: BitLocker cmdlet not available</td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
<tr><td>30. 啟用 Credential Guard</td><td style='color:#6b7280;font-size:12px'>ERROR: cannot query DeviceGuard</td><td>3</td><td style='color:#f9a825;font-weight:700'>Medium</td></tr>
<tr><td>45. LM Hash 儲存限制 (LmCompatibilityLevel)</td><td style='color:#6b7280;font-size:12px'>ERROR: Return code 1</td><td>4</td><td style='color:#ef6c00;font-weight:700'>High</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div style="margin-top:14px;color:var(--muted);font-size:13px">
    說明：三個區域分別顯示通過、不通過與錯誤項目。圖表僅顯示該區域內的項目權重以便比較重要性。
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const PASS_LABELS = ["1. 禁用 Guest 帳號", "4. 密碼複雜度啟用", "5. 密碼重複使用限制 ≥ 24", "6. 密碼最長使用期限 ≤ 90 天", "7. 密碼最短使用期限 ≥ 1 天", "15. 禁止遠端桌面 (若不需要)", "18. 禁止空白密碼登入", "23. 停用 SMBv1 協定", "24. 啟用 Windows Defender", "25. 啟用 Windows 防火牆", "27. 停用未使用的網路介面", "29. 啟用 Secure Boot", "31. 啟用登入稽核", "32. 啟用物件存取稽核", "33. 啟用稽核策略變更", "34. 啟用系統事件稽核", "35. 啟用權限使用稽核", "36. 啟用進程追蹤稽核", "38. 系統日誌大小 ≥ 512MB", "39. 應用程式日誌大小 ≥ 256MB", "40. 日誌覆寫/保留策略設定", "41. 禁止弱加密檢查", "42. 啟用 TLS 1.2/1.3 支援", "43. 禁用 SSL 2.0/3.0", "46. 禁用 NTLMv1", "49. DNSSEC 或 DNS 伺服器角色檢查", "50. 其他網路檢查"];
const PASS_VALUES = [5, 4, 3, 3, 2, 3, 4, 5, 4, 5, 1, 3, 4, 3, 3, 2, 2, 1, 2, 1, 2, 4, 4, 4, 4, 2, 1];
const PASS_COLORS = ["#c62828", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#f9a825", "#ef6c00", "#c62828", "#ef6c00", "#c62828", "#1565c0", "#f9a825", "#ef6c00", "#f9a825", "#f9a825", "#2e7d32", "#2e7d32", "#1565c0", "#2e7d32", "#1565c0", "#2e7d32", "#ef6c00", "#ef6c00", "#ef6c00", "#ef6c00", "#2e7d32", "#1565c0"];

const FAIL_LABELS = ["2. Administrator 帳號應禁用或重新命名", "3. 密碼最小長度 ≥ 12", "8. 帳號鎖定閾值 ≤ 5 次失敗", "10. Kerberos 強加密啟用", "12. 禁止匿名列舉 SAM 帳號", "13. 顯示登入法律聲明", "14. 禁止快取上次登入使用者名稱", "16. 啟用智慧卡或 MFA", "37. 安全日誌大小 ≥ 512MB", "44. 啟用 IPsec 規則", "47. 防火牆阻擋未授權入站流量", "48. 防火牆阻擋未授權出站流量"];
const FAIL_VALUES = [5, 5, 4, 3, 5, 1, 2, 4, 3, 3, 4, 3];
const FAIL_COLORS = ["#c62828", "#c62828", "#ef6c00", "#f9a825", "#c62828", "#1565c0", "#2e7d32", "#ef6c00", "#f9a825", "#f9a825", "#ef6c00", "#f9a825"];

const ERR_LABELS = ["9. 帳號鎖定持續時間 ≥ 15 分鐘", "11. 禁止匿名 SID/名稱轉換", "17. 限制本地管理員群組成員數量", "19. 保留項目 A", "20. 保留項目 B", "21. 停用 Telnet 服務", "22. 停用 FTP 服務", "26. 停用 Remote Registry 服務", "28. 啟用 BitLocker 磁碟加密", "30. 啟用 Credential Guard", "45. LM Hash 儲存限制 (LmCompatibilityLevel)"];
const ERR_VALUES = [3, 5, 3, 1, 1, 4, 3, 4, 4, 3, 4];
const ERR_COLORS = ["#f9a825", "#c62828", "#f9a825", "#1565c0", "#1565c0", "#ef6c00", "#f9a825", "#ef6c00", "#ef6c00", "#f9a825", "#ef6c00"];


function createHorizontalBar(canvasId, labels, values, colors) {
  const el = document.getElementById(canvasId);
  if (!el) return null;
  const ctx = el.getContext('2d');
  // 若無資料，顯示提示文字
  if (!labels || labels.length === 0) {
    ctx.clearRect(0,0,el.width,el.height);
    ctx.font = "14px Arial";
    ctx.fillStyle = "#666";
    ctx.fillText("無資料", 10, 20);
    return null;
  }
  return new Chart(ctx, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        label: '權重',
        data: values,
        backgroundColor: colors,
        borderColor: colors,
        borderWidth: 1
      }]
    },
    options: {
      indexAxis: 'y',
      scales: {
        x: {
          beginAtZero: true,
          ticks: { stepSize: 1 }
        }
      },
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: function(context) {
              return '權重: ' + context.parsed.x;
            }
          }
        }
      },
      responsive: true,
      maintainAspectRatio: false
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  try {
    createHorizontalBar('passChart', PASS_LABELS, PASS_VALUES, PASS_COLORS);
    createHorizontalBar('failChart', FAIL_LABELS, FAIL_VALUES, FAIL_COLORS);
    createHorizontalBar('errChart', ERR_LABELS, ERR_VALUES, ERR_COLORS);
  } catch (e) {
    console.error('Chart render error:', e);
  }
});
</script>
</body>
</html>
